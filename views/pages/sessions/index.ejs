<%- include('../../partials/header') %>
<div class="container">
    <h1>My Sessions</h1>
    
    <% if (sessions.length > 0) { %>
        <div class="sessions-list">
            <% sessions.forEach(session => { %>
                <div class="session-card">
                    <div class="session-info">
                        <h3><%= session.skill %></h3>
                        <p>
                            <% if (session.tutor._id.toString() === user._id.toString()) { %>
                                Student: <%= session.student.firstName %> <%= session.student.lastName %>
                            <% } else { %>
                                Tutor: <%= session.tutor.firstName %> <%= session.tutor.lastName %>
                            <% } %>
                        </p>
                        <% if (session.scheduledDate) { %>
                            <p>Date: <%= new Date(session.scheduledDate).toLocaleDateString() %></p>
                        <% } %>
                        <span class="badge badge-<%= session.status %>"><%= session.status %></span>
                    </div>
                    <div class="session-actions">
                        <% if (session.status === 'pending' && session.tutor._id.toString() === user._id.toString()) { %>
                            <form method="POST" action="/sessions/<%= session._id %>/accept" style="display:inline">
                                <button class="btn btn-primary btn-sm">Accept</button>
                            </form>
                            <form method="POST" action="/sessions/<%= session._id %>/decline" style="display:inline">
                                <button class="btn btn-outline btn-sm">Decline</button>
                            </form>
                        <% } %>
                        <% if (session.status === 'scheduled') { %>
                            <form method="POST" action="/sessions/<%= session._id %>/complete" style="display:inline">
                                <button class="btn btn-primary btn-sm">Mark Complete</button>
                            </form>
                            <form method="POST" action="/sessions/<%= session._id %>/cancel" style="display:inline">
                                <button class="btn btn-outline btn-sm">Cancel</button>
                            </form>
                        <% } %>
                        <% if (session.status === 'completed') { %>
                            <a href="/reviews/new/<%= session._id %>" class="btn btn-outline btn-sm">Leave Review</a>
                        <% } %>
                    </div>
                </div>
            <% }) %>
        </div>
    <% } else { %>
        <p>No sessions yet. <a href="/explore">Find a tutor</a> to get started!</p>
    <% } %>
</div>
<%- include('../../partials/footer') %>
